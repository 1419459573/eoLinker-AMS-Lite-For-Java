!function(e,t,o){"use strict";function r(e){return/^-?\d+\.?\d*$/.test(e.replace(/["']/g,""))}var n=t.isDefined,i=t.isUndefined,a=t.isNumber,c=t.isObject,s=t.isArray,u=t.extend,l=t.toJson,g=t.fromJson,f=t.module("LocalStorageModule",[]);f.provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){this.prefix=e},this.setStorageType=function(e){this.storageType=e},this.setStorageCookie=function(e,t){this.cookie={expiry:e,path:t}},this.setStorageCookieDomain=function(e){this.cookie.domain=e},this.setNotify=function(e,t){this.notify={setItem:e,removeItem:t}},this.$get=["$rootScope","$window","$document","$parse",function(e,t,o,f){var d,m=this,h=m.prefix,S=m.cookie,p=m.notify,T=m.storageType;o?o[0]&&(o=o[0]):o=document,"."!==h.substr(-1)&&(h=h?h+".":"");var y=function(e){return h+e},v=function(){try{var o=T in t&&null!==t[T],r=y("__"+Math.round(1e7*Math.random()));return o&&(d=t[T],d.setItem(r,""),d.removeItem(r)),o}catch(n){return T="cookie",e.$broadcast("LocalStorageModule.notification.error",n.message),!1}}(),O=function(t,o){if(i(o)?o=null:(c(o)||s(o)||a(+o||o))&&(o=l(o)),!v||"cookie"===m.storageType)return v||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:"cookie"}),_(t,o);try{(c(o)||s(o))&&(o=l(o)),d&&d.setItem(y(t),o),p.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:m.storageType})}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),_(t,o)}return!0},b=function(t){if(!v||"cookie"===m.storageType)return v||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(t);var o=d?d.getItem(y(t)):null;return o&&"null"!==o?"{"===o.charAt(0)||"["===o.charAt(0)||r(o)?g(o):o:null},k=function(t){if(!v||"cookie"===m.storageType)return v||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),p.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:"cookie"}),I(t);try{d.removeItem(y(t)),p.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:t,storageType:m.storageType})}catch(o){return e.$broadcast("LocalStorageModule.notification.error",o.message),I(t)}return!0},L=function(){if(!v)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=h.length,o=[];for(var r in d)if(r.substr(0,t)===h)try{o.push(r.substr(t))}catch(n){return e.$broadcast("LocalStorageModule.notification.error",n.Description),[]}return o},$=function(t){t=t||"";var o=h.slice(0,-1),r=new RegExp(o+"."+t);if(!v||"cookie"===m.storageType)return v||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),w();var n=h.length;for(var i in d)if(r.test(i))try{k(i.substr(n))}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),w()}return!0},M=function(){try{return t.navigator.cookieEnabled||"cookie"in o&&(o.cookie.length>0||(o.cookie="test").indexOf.call(o.cookie,"test")>-1)}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),!1}}(),_=function(t,r){if(i(r))return!1;if((s(r)||c(r))&&(r=l(r)),!M)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var n="",a=new Date,u="";if(null===r?(a.setTime(a.getTime()+-864e5),n="; expires="+a.toGMTString(),r=""):0!==S.expiry&&(a.setTime(a.getTime()+24*S.expiry*60*60*1e3),n="; expires="+a.toGMTString()),t){var g="; path="+S.path;S.domain&&(u="; domain="+S.domain),o.cookie=y(t)+"="+encodeURIComponent(r)+n+g+u}}catch(f){return e.$broadcast("LocalStorageModule.notification.error",f.message),!1}return!0},A=function(t){if(!M)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var r=o.cookie&&o.cookie.split(";")||[],n=0;n<r.length;n++){for(var i=r[n];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(y(t)+"=")){var a=decodeURIComponent(i.substring(h.length+t.length+1,i.length));try{var c=JSON.parse(a);return g(c)}catch(s){return a}}}return null},I=function(e){_(e,null)},w=function(){for(var e=null,t=h.length,r=o.cookie.split(";"),n=0;n<r.length;n++){for(e=r[n];" "===e.charAt(0);)e=e.substring(1,e.length);var i=e.substring(t,e.indexOf("="));I(i)}},x=function(){return T},E=function(e,t,o,r){r=r||t;var i=b(r);return null===i&&n(o)?i=o:c(i)&&c(o)&&(i=u(o,i)),f(t).assign(e,i),e.$watch(t,function(e){O(r,e)},c(e[t]))},P=function(){for(var e=0,o=t[T],r=0;r<o.length;r++)0===o.key(r).indexOf(h)&&e++;return e};return{isSupported:v,getStorageType:x,set:O,add:O,get:b,keys:L,remove:k,clearAll:$,bind:E,deriveKey:y,length:P,cookie:{isSupported:M,set:_,add:_,get:A,remove:I,clearAll:w}}}]})}(window,window.angular);